ALTER TABLE schedule_groups DROP CONSTRAINT IF EXISTS uk_jxebxgfip5y9q1b12ajfxl07s;

DROP TABLE IF EXISTS visit_1, visit_2, visit_3, visit_4, visit_5, visit_6, visit_7, visit_8, visit_9, visit_10, visit_11, visit_12;

DROP TABLE IF EXISTS visit;

CREATE TABLE IF NOT EXISTS visit
(
    id          UUID NOT NULL,
    visited     BOOLEAN,
    date        DATE,
    schedule_id UUID CONSTRAINT fkeit1tmoaf5vpdyrk2c23h74g REFERENCES schedule,
    student_id  VARCHAR(255) CONSTRAINT fk2b4q5y6gr7me4vvd4c6svm3ev REFERENCES student,
    CONSTRAINT visit_pkey PRIMARY KEY (id, date)
) PARTITION BY RANGE (date);

CREATE TABLE IF NOT EXISTS visit_1 PARTITION OF visit
    FOR VALUES FROM ('2021-01-01') TO ('2021-02-01');

CREATE TABLE IF NOT EXISTS visit_2 PARTITION OF visit
    FOR VALUES FROM ('2021-02-01') TO ('2021-03-01');

CREATE TABLE IF NOT EXISTS visit_3 PARTITION OF visit
    FOR VALUES FROM ('2021-03-01') TO ('2021-04-01');

CREATE TABLE IF NOT EXISTS visit_4 PARTITION OF visit
    FOR VALUES FROM ('2021-04-01') TO ('2021-05-01');

CREATE TABLE IF NOT EXISTS visit_5 PARTITION OF visit
    FOR VALUES FROM ('2021-05-01') TO ('2021-06-01');

CREATE TABLE IF NOT EXISTS visit_6 PARTITION OF visit
    FOR VALUES FROM ('2021-06-01') TO ('2021-07-01');

CREATE TABLE IF NOT EXISTS visit_7 PARTITION OF visit
    FOR VALUES FROM ('2021-07-01') TO ('2021-08-01');

CREATE TABLE IF NOT EXISTS visit_8 PARTITION OF visit
    FOR VALUES FROM ('2021-08-01') TO ('2021-09-01');

CREATE TABLE IF NOT EXISTS visit_9 PARTITION OF visit
    FOR VALUES FROM ('2021-09-01') TO ('2021-10-01');

CREATE TABLE IF NOT EXISTS visit_10 PARTITION OF visit
    FOR VALUES FROM ('2021-10-01') TO ('2021-11-01');

CREATE TABLE IF NOT EXISTS visit_11 PARTITION OF visit
    FOR VALUES FROM ('2021-11-01') TO ('2021-12-01');

CREATE TABLE IF NOT EXISTS visit_12 PARTITION OF visit
    FOR VALUES FROM ('2021-12-01') TO ('2021-12-31');


